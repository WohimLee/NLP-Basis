# LSTM 

## 1 Intro
LSTM（Long Short-Term Memory，长短期记忆网络）是一种特殊的递归神经网络（RNN），专门用于处理和预测时间序列数据。它通过引入 `门机制` 来解决传统RNN在长时间依赖问题上的不足

>LSTM的基本结构
- LSTM的核心组件包括：
    - 输入门（Input Gate）：控制有多少新的信息被添加到细胞状态中
    - 遗忘门（Forget Gate）：控制细胞状态中有多少信息需要被丢弃
    - 输出门（Output Gate）：控制有多少细胞状态的信息被传递到下一个隐藏状态

    此外，LSTM还包括一个细胞状态（Cell State），它贯穿整个链式结构，用于传递和修改信息

>LSTM的优势
- 长时间依赖：通过门机制有效解决了传统RNN中的梯度消失问题，使得LSTM能够捕捉更长时间的依赖关系。
- 记忆和遗忘能力：LSTM能够选择性地记住或忘记信息，适应复杂的时间序列任务。
- 稳定的梯度：LSTM在训练过程中表现出更稳定的梯度更新，使其在深层网络中依然有效。

>应用领域
- LSTM在许多领域得到了广泛应用，主要包括：
    - 自然语言处理（NLP）：用于语言建模、文本生成、机器翻译等任务
    - 时间序列预测：如股市预测、天气预报等
    - 语音识别：处理音频数据，进行语音识别和生成
    - 视频分析：用于视频分类和动作识别等任务

>总结
- LSTM通过引入输入门、遗忘门和输出门，有效解决了传统RNN在长时间依赖上的问题，使得它在处理复杂时间序列数据时表现出色。其广泛的应用领域和强大的记忆与遗忘能力，使得LSTM成为深度学习中处理序列数据的核心工具之一
    
## 2 工作原理
LSTM的数据流主要包括以下几个步骤：
- 初始化：初始化输入数据、隐藏状态和细胞状态
- 时间步循环：对于每个时间步，LSTM通过输入门、遗忘门和输出门更新隐藏状态和细胞状态
- 生成输出：根据隐藏状态生成输出
- 状态传递：将更新后的隐藏状态和细胞状态传递到下一个时间步

#### 2.1 初始化
- 输入数据 $x_t$：输入序列中的当前时间步的数据
- 隐藏状态 $h_{t-1}$：前一个时间步的隐藏状态
- 细胞状态 $c_{t-1}$：前一个时间步的细胞状态

#### 2.2 时间步循环

对于每个时间步`t`，LSTM更新隐藏状态和细胞状态的过程如下:
##### 2.2.1 计算遗忘门

遗忘门决定了前一个时间步的细胞状态 $c_{t-1}$ 有多少被保留到当前时间步:
$$f_t=\sigma\left(W_f \cdot\left[h_{t-1}, x_t\right]+b_f\right)$$
- $W_f$ : 遗忘门的权重矩阵
- $b_f$ : 遗忘门的偏置向量
- $\sigma$ : sigmoid激活函数

##### 2.2.2 计算输入门

输入门决定了当前时间步的输入信息 $x_t$ 有多少被写入到细胞状态:
$$
i_t=\sigma\left(W_i \cdot\left[h_{t-1}, x_t\right]+b_i\right)
$$
- $W_i$ : 输入门的权重矩阵
- $b_i$ : 输入门的偏置向量

##### 2.2.3 计算候选细胞状态

候选细胞状态 $C_t$ 包含了当前时间步的新信息：
$$\tilde{C}_t=\tanh \left(W_C \cdot\left[h_{t-1}, x_t\right]+b_C\right)$$
- $W_C$ ：候选细胞状态的权重矩阵
- $b_C$ ：候选细胞状态的偏置向量
- tanh：tanh激活函数

##### 2.2.4 更新细胞状态

结合遗忘门和输入门，更新细胞状态：
$$C_t=f_t \odot C_{t-1}+i_t \odot \tilde{C}_t$$
- $\odot$: 元素级乘法

##### 2.2.5 计算输出门

输出门决定了当前时间步的隐藏状态有多少被输出:
$$
o_t=\sigma\left(W_o \cdot\left[h_{t-1}, x_t\right]+b_o\right)
$$
- $W_o$ : 输出门的权重矩阵
- $b_0$ ：输出门的偏置向量

##### 2.2.6 计算隐藏状态

结合输出门和更新后的细胞状态, 计算当前时间步的隐藏状态：
$$
h_t=o_t \odot \tanh \left(C_t\right)
$$

#### 2.3 生成输出

输出通常由当前时间步的隐藏状态 $h_t$ 决定：
$$y_t=W_{h y} \cdot h_t+b_y$$
- $W_{h y}$ ：隐藏层到输出层的权重矩阵
- $b_y$ : 输出层的偏置向量

#### 2.4 状态传递

将当前时间步更新后的隐藏状态 $h_t$ 和细胞状态 $C_t$ 传递到下一个时间步 `(t+1)` 

